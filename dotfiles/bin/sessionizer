#!/usr/bin/env bash

PROJECT_FOLDERS=("$HOME/projects/" "$HOME/.config/")
PROJECT=$(find ${PROJECT_FOLDERS[@]} -mindepth 1 -maxdepth 1 -type d  | fzf)

if [ -n "$PROJECT" ]; then
	cd "$PROJECT" || exit
	SESSION_NAME=$(basename "$PROJECT")

	if tmux has-session -t "$SESSION_NAME" 2>/dev/null; then
		exec tmux a -t "$SESSION_NAME"
	else
		tmux new-session -d -s "$SESSION_NAME" -c "$PROJECT"
		tmux new-window -t "$SESSION_NAME" -c "$PROJECT" "nvim ."
		tmux new-window -t "$SESSION_NAME" -c "$PROJECT"
		tmux select-window -t "$SESSION_NAME:2"
		exec tmux attach -t "$SESSION_NAME"
	fi
fi
